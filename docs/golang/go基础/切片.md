# Go 语言切片详解

## 1. 切片概述

切片（Slice）是 Go 语言中一种动态数组类型，提供了对数组的灵活且高效的抽象。与数组相比，切片的长度可以动态变化，是 Go 语言中最常用的数据结构之一。

## 2. 切片语法

### 2.1 定义切片

```
// 声明一个字符串切片
var strSlice []string

// 声明一个整数切片并初始化
numSlice := []int{1, 2, 3, 4, 5}
```

### 2.2 使用 make 函数创建切片

```
// 创建一个长度为3，容量为5的整数切片
slice := make([]int, 3, 5)
```

### 2.3 从数组或切片创建切片

```
arr := [5]int{1, 2, 3, 4, 5}
// 从数组创建切片，包含元素2,3,4（索引1到3，左闭右开）
slice := arr[1:4]
```

### 2.4 切片的长度和容量

```
slice := []int{1, 2, 3, 4, 5}
length := len(slice)  // 长度：5
capacity := cap(slice) // 容量：5
```

## 3. 切片底层实现

切片在底层由三部分组成：

- 指向底层数组的指针（pointer）
- 切片的长度（len）
- 切片的容量（cap）

![img](data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27400%27%20height=%27153.1914893617021%27/%3e)![image](https://go.dev/blog/slices-intro/slice-struct.png)

## 4. 切片常用操作

### 4.1 追加元素

```
slice := []int{1, 2, 3}
// 追加单个元素
slice = append(slice, 4)
// 追加多个元素
slice = append(slice, 5, 6, 7)
// 追加另一个切片
anotherSlice := []int{8, 9, 10}
slice = append(slice, anotherSlice...)
```

### 4.2 切片截取

```
slice := []int{1, 2, 3, 4, 5}
// 截取索引1到3的元素（左闭右开）
subSlice := slice[1:4] // [2, 3, 4]
```

### 4.3 复制切片

```
source := []int{1, 2, 3}
destination := make([]int, len(source))
copy(destination, source)
```

## 5. 切片扩容机制

当切片容量不足以容纳新元素时，Go 会创建一个新的底层数组，并将原数组的元素复制到新数组中。扩容规则：

- 当原切片容量小于 1024 时，新容量为原容量的 2 倍
- 当原切片容量大于等于 1024 时，新容量为原容量的 1.25 倍

## 6. 注意事项

- 切片本身不存储数据，它只是底层数组的一个引用
- 修改切片元素会影响底层数组和引用同一数组的其他切片
- 当切片容量足够时，append 操作会直接修改底层数组
- 当切片容量不足时，append 操作会创建新的底层数组